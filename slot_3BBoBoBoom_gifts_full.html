<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>3B Bo Bo Boom Slot - Gifts Full</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: #02030a;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .slot-wrapper {
      text-align: center;
      color: #fff;
    }

    .title {
      font-size: 32px;
      font-weight: 800;
      letter-spacing: 1px;
      margin-bottom: 10px;
      text-transform: uppercase;
    }

    .subtitle {
      font-size: 14px;
      opacity: 0.8;
      margin-bottom: 18px;
    }

    .reels {
      display: flex;
      justify-content: center;
      gap: 16px;
      padding: 20px 30px;
      border-radius: 18px;
      background: radial-gradient(circle at top, #ff007a, #3b0266 40%, #05040a 80%);
      box-shadow: 0 0 25px rgba(255, 0, 122, 0.6);
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .reel {
      width: 80px;
      height: 80px;
      border-radius: 14px;
      background: #050712;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 38px;
      border: 2px solid rgba(255, 255, 255, 0.25);
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.7);
    }

    .status {
      margin-top: 16px;
      font-size: 18px;
      min-height: 24px;
      max-width: 520px;
      margin-left: auto;
      margin-right: auto;
    }

    .spin-btn {
      margin-top: 16px;
      padding: 8px 18px;
      font-size: 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg, #ff007a, #ffb800);
      color: #05030a;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      display: none; /* passe Ã  block pour tester en local */
    }

    .reel.spinning {
      animation: spin 0.18s linear infinite;
    }

    @keyframes spin {
      0%   { transform: translateY(0); }
      50%  { transform: translateY(-6px); }
      100% { transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="slot-wrapper">
    <div class="title">3B Bo Bo Boom ğŸ°</div>
    <div class="subtitle" id="subtitle">Merci pour le cadeau TikTok ğŸ’–</div>

    <div class="reels">
      <div class="reel" id="reel1">ğŸ</div>
      <div class="reel" id="reel2">ğŸ</div>
      <div class="reel" id="reel3">ğŸ</div>
      <div class="reel" id="reel4">ğŸ</div>
    </div>

    <div class="status" id="status"></div>
    <button class="spin-btn" id="spinBtn">Spin</button>
  </div>

  <script>
    // Liste des cadeaux (approx visuels avec emoji, tu pourras mettre de vraies images plus tard)
    const symbols = [
      { id: "gants_boxe_ores", display: "ğŸ¥Š", giftName: "Gants de boxe dorÃ©s" },
      { id: "pass_aventure", display: "ğŸ«", giftName: "Pass aventure" },
      { id: "cochon_amoureux", display: "ğŸ·â¤ï¸", giftName: "Cochon amoureux" },
      { id: "coeur_doigts", display: "ğŸ«°", giftName: "CÅ“ur avec les doigts" },
      { id: "tofu", display: "ğŸ§€", giftName: "Tofu" },
      { id: "creme_glacee", display: "ğŸ¨", giftName: "CrÃ¨me glacÃ©e" },
      { id: "peche", display: "ğŸ‘", giftName: "PÃªche" },
      { id: "pouce_haut", display: "ğŸ‘", giftName: "Pouce vers le haut" },
      { id: "slay", display: "ğŸ˜µâ€ğŸ’«", giftName: "Slay" },
      { id: "cornet_glace", display: "ğŸ¦", giftName: "Cornet de crÃ¨me glacÃ©e" },
      { id: "rose", display: "ğŸŒ¹", giftName: "Rose" },
      { id: "tiktok_logo", display: "ğŸµ", giftName: "TikTok" },

      { id: "amour_langage", display: "ğŸ¤Ÿ", giftName: "Amour en langage des signes" },
      { id: "bagel", display: "ğŸ¥¯", giftName: "Bagel" },
      { id: "donut", display: "ğŸ©", giftName: "Donut" },
      { id: "you_are_my_jam", display: "ğŸ“", giftName: "You are my Jam" },
      { id: "miso", display: "ğŸœ", giftName: "U make Miso happy" },
      { id: "on_a_roll", display: "ğŸ¥", giftName: "You are on a Roll" },
      { id: "capybara", display: "ğŸ¹", giftName: "Capybara" },
      { id: "fleurs_s", display: "ğŸ’", giftName: "Fleurs S" },
      { id: "parfum", display: "ğŸ’„", giftName: "Parfum" },
      { id: "bougie", display: "ğŸ•¯ï¸", giftName: "Bougie" },
      { id: "rosa", display: "ğŸŒ¹", giftName: "Rosa" },
      { id: "collier_amitie", display: "ğŸ’", giftName: "Collier d'amitiÃ©" },

      { id: "signe_coeur", display: "ğŸ¤", giftName: "Signe du cÅ“ur" },
      { id: "manette_jeu", display: "ğŸ®", giftName: "Manette de jeu" },
      { id: "energie_coquillage", display: "ğŸš", giftName: "Ã‰nergie dans un coquillage" },
      { id: "coeur_mains", display: "ğŸ¤²", giftName: "CÅ“ur dans les mains" },
      { id: "party_horn", display: "ğŸ‰", giftName: "Cadeau fÃªte" },
      { id: "ours_coeur", display: "ğŸ§¸", giftName: "Ours avec cÅ“ur" },
      { id: "coeur_orbite", display: "ğŸ’˜", giftName: "CÅ“ur en orbite" },
      { id: "cible_coeur", display: "ğŸ¯", giftName: "Cible cÅ“ur" },

      // Gros cadeaux perso que tu as montrÃ©s en screen :
      { id: "orb_arc_en_ciel", display: "ğŸŒ€", giftName: "Orbe arc-en-ciel" },
      { id: "money_gun", display: "ğŸ’¸", giftName: "Pistolet TikTok money" },
      { id: "aigle", display: "ğŸ¦…", giftName: "Aigle" },
      { id: "moto_future", display: "ğŸï¸", giftName: "Moto futuriste" },
      { id: "leon_chaton", display: "ğŸ¦", giftName: "LÃ©on chaton" }
    ];

    const reels = [
      document.getElementById("reel1"),
      document.getElementById("reel2"),
      document.getElementById("reel3"),
      document.getElementById("reel4")
    ];
    const statusEl = document.getElementById("status");
    const spinBtn = document.getElementById("spinBtn");
    const subtitleEl = document.getElementById("subtitle");

    // RÃ©cup paramÃ¨tre ?user=Pseudo
    function getParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    const viewerName = getParam("user") || "toi";

    // Sous-titre personnalisÃ©
    subtitleEl.textContent = `Merci pour le cadeau, ${viewerName} ğŸ’–`;

    function randomSymbol() {
      return symbols[Math.floor(Math.random() * symbols.length)];
    }

    function randomFrom(list) {
      return list[Math.floor(Math.random() * list.length)];
    }

    function getGiftWinMessage(symbolObj) {
      // message spÃ©cifique par cadeau
      return `${symbolObj.display} ${viewerName}, 4 ${symbolObj.giftName} alignÃ©s ! Je te dois ${symbolObj.giftName} sur TikTok.`;
    }

    function evaluateResult(result) {
      // Compter les occurrences par id
      const counts = {};
      result.forEach(symObj => {
        counts[symObj.id] = (counts[symObj.id] || 0) + 1;
      });

      const maxCount = Math.max(...Object.values(counts));

      const loseMessages = [
        `Merci pour le cadeau ${viewerName} ğŸ’– Rappel : tu gagnes seulement si tu as les 4 mÃªmes cadeaux.`,
        `ğŸ˜ˆ ${viewerName}, pas encoreâ€¦ Pour gagner, il faut 4 symboles identiques.`,
        `ğŸ§¨ ${viewerName}, la machine est chaude. 4 symboles identiques = je tâ€™envoie ce cadeau.`,
        `${viewerName}, rÃ¨gle officielle : 4 cadeaux identiques = tu remportes ce mÃªme cadeau.`
      ];

      if (maxCount === 4) {
        // Trouver l'id gagnant
        let winningId = null;
        for (const id in counts) {
          if (counts[id] === 4) {
            winningId = id;
            break;
          }
        }
        const winningSymbolObj = symbols.find(s => s.id === winningId);
        statusEl.textContent = getGiftWinMessage(winningSymbolObj);
      } else {
        statusEl.textContent = randomFrom(loseMessages);
      }
    }

    function spinOnce() {
      statusEl.textContent = `Bo Bo Boom en cours pour ${viewerName}...`;
      const result = [];

      reels.forEach((reel) => {
        reel.classList.add("spinning");
      });

      const spinDuration = 1400;

      setTimeout(() => {
        reels.forEach((reel, index) => {
          const symObj = randomSymbol();
          result[index] = symObj;
          reel.textContent = symObj.display;
          reel.classList.remove("spinning");
        });

        evaluateResult(result);
      }, spinDuration);
    }

    window.addEventListener("load", () => {
      // Ticfinity recharge lâ€™overlay Ã  chaque cadeau â†’ spin automatique
      spinOnce();
    });

    spinBtn.addEventListener("click", spinOnce);
  </script>
</body>
</html>
