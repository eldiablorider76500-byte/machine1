<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Slot 3B TikTok</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #0b0f1a;
        color: white;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    h1 {
        margin-top: 40px;
        color: #f4d03f;
        text-shadow: 0 0 15px #ff00ff;
        font-size: 40px;
    }
    .slot-container {
        margin: 40px auto;
        width: 700px;
        background: rgba(40, 0, 60, 0.6);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 0 25px #ff00cc;
    }
    .reels {
        display: flex;
        justify-content: center;
        background: black;
        padding: 20px;
        border-radius: 15px;
        border: 5px solid #ff00ff;
        margin-bottom: 20px;
    }
    .reel {
        width: 120px;
        height: 120px;
        margin: 0 10px;
        background: #111;
        border-radius: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .reel img {
        width: 100px;
        height: 100px;
    }
    button {
        padding: 12px 26px;
        font-size: 20px;
        margin: 10px;
        border-radius: 8px;
        cursor: pointer;
        border: none;
        font-weight: bold;
    }
    #spinBtn {
        background: limegreen;
        color: black;
    }
    #addManual {
        background: orange;
    }
    .side-panel {
        margin-top: 20px;
    }
    #history, #queue {
        background: rgba(255,255,255,0.1);
        padding: 15px;
        border-radius: 10px;
        width: 300px;
        margin: 10px auto;
        text-align: left;
        font-size: 14px;
    }
</style>
</head>

<body>

<h1>SLOT 3B TIKTOK</h1>

<div class="slot-container">

    <div class="reels">
        <div class="reel" id="reel1"></div>
        <div class="reel" id="reel2"></div>
        <div class="reel" id="reel3"></div>
    </div>

    <div>
        <button id="addManual">Ajouter (manuel)</button>
        <button id="spinBtn">SPIN</button>
    </div>

    <div class="side-panel">
        <div id="queue"><b>File d’attente :</b><br>0 joueur(s)</div>
        <div id="history"><b>Historique :</b><br></div>
    </div>

</div>

<script>
/* --- ÉMOTES --- */
const icons = [
    "https://i.imgur.com/G8vdXLL.png",
    "https://i.imgur.com/vt2N6hE.png",
    "https://i.imgur.com/KkvyH2L.png",
    "https://i.imgur.com/6jQy2rA.png"
];

/* --- DOM --- */
const r1 = document.getElementById("reel1");
const r2 = document.getElementById("reel2");
const r3 = document.getElementById("reel3");
const btnSpin = document.getElementById("spinBtn");
const btnAdd = document.getElementById("addManual");
const queueDiv = document.getElementById("queue");
const historyDiv = document.getElementById("history");

/* FILE D’ATTENTE */
let file = [];

/* AUTO-AJOUT LORS D’UN CADEAU (tu appelles cette fonction quand TikTok envoie l’event) */
function ajouterPseudoAuto(pseudo) {
    file.push(pseudo);
    majFile();
}

/* MODE MANUEL */
btnAdd.addEventListener("click", () => {
    const pseudo = "Joueur_" + Math.floor(Math.random() * 9999);
    file.push(pseudo);
    majFile();
});

/* MET À JOUR L’AFFICHAGE FILE */
function majFile() {
    queueDiv.innerHTML = "<b>File d’attente :</b><br>" + file.length + " joueur(s)<br><br>";
    file.forEach(p => {
        queueDiv.innerHTML += "• " + p + "<br>";
    });
}

/* SPIN */
btnSpin.addEventListener("click", spin);

function spin() {
    if (file.length === 0) {
        alert("Aucun joueur dans la file !");
        return;
    }

    const joueur = file.shift();
    majFile();

    const i1 = randomIcon();
    const i2 = randomIcon();
    const i3 = randomIcon();

    r1.innerHTML = `<img src="${i1}">`;
    r2.innerHTML = `<img src="${i2}">`;
    r3.innerHTML = `<img src="${i3}">`;

    let gain = "PERDU";
    if (i1 === i2 && i2 === i3) gain = "MEGA WIN";
    else if (i1 === i2 || i2 === i3 || i1 === i3) gain = "GAGNE";

    addHistory(joueur, gain);
}

/* RANDOM */
function randomIcon() {
    return icons[Math.floor(Math.random() * icons.length)];
}

/* HISTORIQUE */
function addHistory(user, result) {
    historyDiv.innerHTML += `<br><b>${user}</b> → ${result}`;
}
</script>

</body>
</html>
