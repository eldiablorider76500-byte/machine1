<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Machine à sous TikTok</title>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1d3350 0, #050811 55%, #02030a 100%);
      color:#fff;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .machine-wrapper {
      width:90vw;
      max-width:1100px;
      height:90vh;
      max-height:650px;
      border-radius:40px;
      padding:20px 24px 28px;
      background:linear-gradient(180deg,#2c0f33 0%,#120615 50%,#20183b 100%);
      box-shadow:0 0 40px rgba(0,0,0,0.8),0 0 80px rgba(147,51,234,0.6);
      display:flex;
      flex-direction:column;
      position:relative;
      overflow:hidden;
    }

    .machine-header {
      text-align:center;
      margin-bottom:10px;
    }

    .machine-title {
      font-size:32px;
      letter-spacing:3px;
      text-transform:uppercase;
      font-weight:800;
      color:#ffd54f;
      text-shadow:0 0 12px rgba(255,215,0,0.9),0 0 24px rgba(255,64,129,0.7);
    }

    .machine-subtitle {
      margin-top:4px;
      font-size:13px;
      color:#e1e1ff;
      opacity:0.85;
    }

    .top-status {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin:10px 0 12px;
      font-size:13px;
      color:#e5e5ff;
    }

    .player-info span {
      font-weight:600;
      color:#ffeb3b;
    }

    .spin-counter {
      font-size:12px;
      color:#b0a5ff;
    }

    .machine-body {
      flex:1;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .reels-container {
      flex:1;
      border-radius:26px;
      padding:18px 14px;
      background:radial-gradient(circle at top,#3147a0,#0b1023 55%,#040612 100%);
      box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:hidden;
    }

    .reels-frame {
      width:100%;
      max-width:820px;
      height:100%;
      max-height:320px;
      border-radius:22px;
      padding:16px;
      background:linear-gradient(180deg,#ff00b8,#ff9100);
      box-shadow:0 0 28px rgba(255,64,129,0.65);
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .reels-inner {
      flex:1;
      height:100%;
      background:radial-gradient(circle at top,#121b33,#050814 70%);
      border-radius:18px;
      border:4px solid rgba(255,255,255,0.05);
      display:flex;
      justify-content:space-evenly;
      align-items:center;
      padding:10px 14px;
      gap:10px;
    }

    .reel {
      flex:1;
      max-width:150px;
      height:100%;
      border-radius:16px;
      background:linear-gradient(180deg,#171f33,#050713);
      box-shadow:inset 0 0 15px rgba(0,0,0,0.8);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      position:relative;
    }

    .reel img {
      width:80%;
      max-height:90%;
      object-fit:contain;
      filter:drop-shadow(0 0 12px rgba(0,0,0,0.9));
      transition:transform 0.08s linear;
    }

    .reel.spinning img {
      animation:wiggle 0.1s linear infinite;
      opacity:0.9;
    }

    @keyframes wiggle {
      0%{transform:translateY(-4px);}
      50%{transform:translateY(4px);}
      100%{transform:translateY(-4px);}
    }

    .win-banner {
      position:absolute;
      top:10px;
      left:50%;
      transform:translateX(-50%);
      padding:6px 16px;
      border-radius:999px;
      background:rgba(0,0,0,0.6);
      border:1px solid rgba(255,255,255,0.2);
      font-size:13px;
      text-transform:uppercase;
      letter-spacing:1px;
      color:#fff;
      display:none;
      align-items:center;
      gap:8px;
      pointer-events:none;
    }

    .win-banner span { font-weight:700; }
    .win-banner.big span  { color:#ffeb3b; }
    .win-banner.mega span { color:#00e5ff; }
    .win-banner.giga span { color:#ff1744; }

    .machine-footer {
      display:flex;
      gap:14px;
      align-items:center;
      margin-top:6px;
    }

    .control-panel {
      flex:2;
      background:rgba(0,0,0,0.4);
      border-radius:18px;
      padding:10px 14px;
      display:flex;
      flex-wrap:wrap;
      gap:8px 12px;
      align-items:center;
      font-size:13px;
    }

    .control-panel label {
      font-size:12px;
      color:#ddd;
    }

    .control-panel input {
      background:rgba(7,10,26,0.9);
      border:1px solid rgba(255,255,255,0.15);
      color:#fff;
      border-radius:999px;
      padding:5px 10px;
      font-size:13px;
      outline:none;
      min-width:110px;
    }

    .control-panel input:focus {
      border-color:#ff80ff;
      box-shadow:0 0 0 1px rgba(255,128,255,0.4);
    }

    .buttons-panel {
      flex:1;
      display:flex;
      justify-content:flex-end;
      gap:8px;
    }

    .btn {
      border-radius:999px;
      border:none;
      padding:9px 18px;
      font-size:14px;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:1px;
      cursor:pointer;
      transition:transform 0.08s ease, box-shadow 0.08s ease, opacity 0.08s ease;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:6px;
    }

    .btn-primary {
      background:radial-gradient(circle at top,#00e676,#00b0ff);
      color:#011017;
      box-shadow:0 0 14px rgba(0,230,118,0.6);
    }

    .btn-secondary {
      background:radial-gradient(circle at top,#ffea00,#ff6f00);
      color:#120300;
      box-shadow:0 0 14px rgba(255,193,7,0.6);
    }

    .btn:disabled {
      opacity:0.45;
      cursor:not-allowed;
    }

  </style>
</head>

<body>

  <div class="machine-wrapper">

    <div class="machine-header">
      <div class="machine-title">Slot 3B TikTok</div>
      <div class="machine-subtitle">
        4 mêmes cadeaux sur la ligne = gain • Loup = <strong>GIGA WIN</strong> • Moto = <strong>MEGA WIN</strong>
      </div>
    </div>

    <div class="top-status">
      <div class="player-info">
        Joueur : <span id="playerNameDisplay">-</span> • Cadeau : 
        <span id="giftCoinsDisplay">0</span> pièces • Tours : 
        <span id="spinsLeftDisplay">0</span>
      </div>
      <div class="spin-counter">
        Tours joués : <span id="totalSpinsDisplay">0</span>
      </div>
    </div>

    <div class="reels-container">
      <div class="reels-frame">
        <div class="reels-inner">
          <div class="reel" data-index="0"><img src=""></div>
          <div class="reel" data-index="1"><img src=""></div>
          <div class="reel" data-index="2"><img src=""></div>
          <div class="reel" data-index="3"><img src=""></div>
        </div>
      </div>
    </div>

    <div class="machine-footer">

      <div class="control-panel">
        <div>
          <label>Pseudo TikTok :</label><br>
          <input id="playerName" type="text" placeholder="Pseudo…" />
        </div>

        <div>
          <label>Cadeau (en pièces) :</label><br>
          <input id="giftCoins" type="number" min="1" placeholder="ex : 99" />
        </div>
      </div>

      <div class="buttons-panel">
        <button id="setGiftBtn" class="btn btn-secondary">Valider</button>
        <button id="spinBtn" class="btn btn-primary" disabled>SPIN</button>
      </div>

    </div>

  </div>

  <script>
    const IMAGE_BASE_PATH = "Cadeaux/";

    const SYMBOLS = [
      "IMG-20251120-WA0017.jpg",
      "IMG-20251120-WA0018.jpg",
      "IMG-20251120-WA0019.jpg",
      "IMG-20251120-WA0020.jpg",
      "IMG-20251120-WA0021.jpg",
      "IMG-20251120-WA0022.jpg",
      "IMG-20251120-WA0023.jpg",
      "IMG-20251120-WA0024.jpg",
      "IMG-20251120-WA0025.jpg",
      "IMG-20251120-WA0026.jpg",
      "IMG-20251120-WA0027.jpg",
      "IMG-20251120-WA0028.jpg",
      "IMG-20251120-WA0029.jpg",
      "IMG-20251120-WA0030.jpg",
      "IMG-20251120-WA0031.jpg",
      "IMG-20251120-WA0032.jpg",
      "IMG-20251120-WA0033.jpg",
      "IMG-20251120-WA0034.jpg",
      "IMG-20251120-WA0035.jpg",
      "IMG-20251120-WA0042.jpg"
    ];

    function randSymbol() {
      return SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];
    }

    const reels = document.querySelectorAll(".reel img");

    function initReels() {
      reels.forEach(img => {
        img.src = IMAGE_BASE_PATH + randSymbol();
      });
    }

    initReels();

    let currentPlayer = "-";
    let giftCoins = 0;
    let spinsLeft = 0;
    let totalSpins = 0;
    let spinning = false;

    function updateDisplay() {
      document.getElementById("playerNameDisplay").textContent = currentPlayer;
      document.getElementById("giftCoinsDisplay").textContent = giftCoins;
      document.getElementById("spinsLeftDisplay").textContent = spinsLeft;
      document.getElementById("totalSpinsDisplay").textContent = totalSpins;
    }

    updateDisplay();

    document.getElementById("setGiftBtn").onclick = () => {
      const name = document.getElementById("playerName").value.trim();
      const coins = parseInt(document.getElementById("giftCoins").value);

      if (!name || isNaN(coins)) return alert("Entre un pseudo et un cadeau.");

      currentPlayer = name;
      giftCoins = coins;

      // règles de tours
      let s = 0;
      if (coins >= 2999) s = 70;
      else if (coins >= 299) s = 7;
      else if (coins >= 99) s = 3;
      else if (coins >= 49) s = 1;

      spinsLeft += s;

      updateDisplay();
      document.getElementById("spinBtn").disabled = false;
    };

    document.getElementById("spinBtn").onclick = () => {
      if (spinning) return;
      if (spinsLeft <= 0) return alert("Plus de tours.");

      spinning = true;
      spinsLeft--;
      totalSpins++;

      updateDisplay();

      const intervals = [100,100,100,100];
      const durations = [800,1100,1400,1700];

      reels.forEach((img, i) => {
        const int = setInterval(() => {
          img.src = IMAGE_BASE_PATH + randSymbol();
        }, intervals[i]);

        setTimeout(() => {
          clearInterval(int);
          img.src = IMAGE_BASE_PATH + randSymbol();

          if (i === reels.length - 1) {
            spinning = false;
            if (spinsLeft <= 0) {
              document.getElementById("spinBtn").disabled = true;
            }
          }
        }, durations[i]);
      });
    };
  </script>
</body>
</html>
